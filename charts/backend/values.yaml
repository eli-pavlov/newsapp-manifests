# backend defaults
app:
  name: backend
  syncWave: "1"

image:
  repository: ""
  tag: "latest"
  pullPolicy: IfNotPresent

replicaCount: 1

service:
  type: ClusterIP
  port: 3000

podSecurityContext: {}
containerSecurityContext: {}

resources:
  requests:
    cpu: 100m
    memory: 256Mi
  limits:
    cpu: 500m
    memory: 512Mi

nodeSelector: {}
tolerations: []
affinity: {}

imagePullSecrets: []

env:
  plain: {}
  secretRef: ""
  configRef: ""

hpa:
  enabled: false

probes:
  readiness:
    enabled: true
    type: http
    path: /healthz
    scheme: HTTP
    initialDelaySeconds: 5
    periodSeconds: 10
    timeoutSeconds: 2
    successThreshold: 1
    failureThreshold: 3

  liveness:
    enabled: true
    type: http
    path: /healthz
    scheme: HTTP
    initialDelaySeconds: 30
    periodSeconds: 10
    timeoutSeconds: 2
    successThreshold: 1
    failureThreshold: 6

  startup:
    enabled: false
    type: http
    path: /healthz
    scheme: HTTP
    periodSeconds: 5
    failureThreshold: 30

networkPolicy:
  enabled: true
  backendEgressWeb:
    enabled: true
    exceptCidrs: []
    ports: [80, 443]

  backendEgressDb:
      enabled: true
      dbSelector:
        matchLabels:
          app.kubernetes.io/name: postgresql
      dbPort: 5432

# --------- Ephemeral persistence (emptyDir) configuration ----------
persistence:
  enabled: false             # set true to create the emptyDir mount in pod
  type: emptyDir            # only "emptyDir" supported by this chart snippet
  mountPath: /data/uploads  # path inside container where app writes transient files

  # chown settings for the initContainer (useful when the container runs non-root)
  chown:
    enabled: true
    uid: 1000
    gid: 1000

  # Security defaults you can override per-environment:
  security:
    uid: 1000
    gid: 1000

  # Provide explicit pod / container security context defaults
  podSecurityContext:
    fsGroup: 1000

  containerSecurityContext:
    runAsUser: 1000
